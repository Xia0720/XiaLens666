{% extends "base.html" %}
{% block title %}Albums - XiaCapture{% endblock %}
{% block content %}
<h1 style="text-align:center; margin-top:20px;">Albums</h1>

<!-- 重命名功能输入框 -->
<div style="text-align:center; margin-bottom:20px;">
    <input type="text" id="oldName" placeholder="Old album name" style="padding:6px; margin-right:5px;">
    <input type="text" id="newName" placeholder="New album name" style="padding:6px; margin-right:5px;">
    <button onclick="renameAlbum()" style="padding:6px 12px;">Rename Album</button>
</div>

<div class="album-grid">
  {% for album in albums %}
    <div class="album-item">
      <a href="{{ url_for('view_album', album_name=album.name) }}">
        {% if album.cover %}
          <img src="{{ album.cover }}" alt="{{ album.name }}">
        {% else %}
          <div style="width:200px; height:200px; background:#ccc; border-radius:8px; display:flex; align-items:center; justify-content:center;">
            No cover
          </div>
        {% endif %}
        <p style="margin-top:8px;">{{ album.name }}</p>
      </a>
    </div>
  {% endfor %}
</div>

<script>
function renameAlbum() {
    const oldName = document.getElementById('oldName').value.trim();
    const newName = document.getElementById('newName').value.trim();

    if (!oldName || !newName) {
        alert("Please enter both old and new album names");
        return;
    }

    fetch('/rename_album', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ old_name: oldName, new_name: newName })
    })
    .then(res => res.json())
    .then(data => {
        if (data.success) {
            alert(data.message);
            location.reload(); // 刷新页面
        } else {
            alert("Rename failed: " + data.error);
        }
    })
    .catch(err => {
        alert("Error: " + err);
    });
}
</script>
{% endblock %}











