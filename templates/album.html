{% extends "base.html" %}
{% block title %}Albums - XiaCapture{% endblock %}
{% block content %}
<h1 style="text-align:center; margin-top:20px;">Albums</h1>
<div class="album-grid">
  {% for album in albums %}
    <div class="album-item" style="text-align:center;">
      <a href="{{ url_for('view_album', album_name=album.name) }}">
        {% if album.cover %}
          <img src="{{ album.cover }}" alt="{{ album.name }}">
        {% else %}
          <div style="width:200px; height:200px; background:#ccc; border-radius:8px; display:flex; align-items:center; justify-content:center;">
            No cover
          </div>
        {% endif %}
        <p style="margin-top:8px;">{{ album.name }}</p>
      </a>
      <!-- 重命名按钮 -->
      <button onclick="renameAlbum('{{ album.name }}')">Rename</button>
    </div>
  {% endfor %}
</div>

<script>
function renameAlbum(oldName) {
    const newName = prompt("Enter new album name for '" + oldName + "':");
    if (!newName) return; // 用户取消或没输入

    fetch('/rename_album', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ old_name: oldName, new_name: newName })
    })
    .then(res => res.json())
    .then(data => {
        if (data.success) {
            alert(data.message);
            location.reload();
        } else {
            alert("Rename failed: " + data.error);
        }
    })
    .catch(err => {
        alert("Error: " + err);
    });
}
</script>
{% endblock %}











